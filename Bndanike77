local player = game.Players.LocalPlayer
local JUMP_POWER_DEFAULT = 50
local jumpEnabled = true -- true = pulo liberado

-- FunÃ§Ã£o pra ligar/desligar o pulo
local function setJumpEnabled(enabled)
	local character = player.Character or player.CharacterAdded:Wait()
	local humanoid = character:FindFirstChildOfClass("Humanoid")
	if humanoid then
		if enabled then
			humanoid.JumpPower = JUMP_POWER_DEFAULT
		else
			humanoid.JumpPower = 0
			humanoid.Jump = false
		end
	end
end

-- Criar o botÃ£o flutuante
local function createFloatingButton()
	local screenGui = Instance.new("ScreenGui")
	screenGui.Name = "JumpToggleGui"
	screenGui.ResetOnSpawn = false
	screenGui.Parent = player:WaitForChild("PlayerGui")

	local button = Instance.new("TextButton")
	button.Name = "FloatingJumpButton"
	button.Size = UDim2.new(0, 40, 0, 40)
	button.Position = UDim2.new(0, 10, 0.5, -20)
	button.BorderSizePixel = 0
	button.TextSize = 12
	button.AutoButtonColor = false
	button.Parent = screenGui
	button.ClipsDescendants = true

	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(1, 0)
	corner.Parent = button

	-- Visual
	local function updateVisual()
		if jumpEnabled then
			button.Text = "OFF"
			button.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
			button.TextColor3 = Color3.fromRGB(0, 0, 0)
		else
			button.Text = "ON"
			button.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
			button.TextColor3 = Color3.fromRGB(255, 140, 0)
		end
	end

	----------------------------------------------------------------
	-- ðŸ”¥ DRAG MELHORADO (EXTREMO, SUAVE, PC + MOBILE)
	----------------------------------------------------------------
	local UIS = game:GetService("UserInputService")
	local dragging = false
	local dragStart
	local startPos
	local activeInput

	button.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1
		or input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = input.Position
			startPos = button.Position
			activeInput = input
		end
	end)

	button.InputEnded:Connect(function(input)
		if input == activeInput then
			dragging = false
			activeInput = nil
		end
	end)

	UIS.InputChanged:Connect(function(input)
		if dragging and input == activeInput then
			local delta = input.Position - dragStart
			button.Position = UDim2.new(
				startPos.X.Scale,
				startPos.X.Offset + delta.X,
				startPos.Y.Scale,
				startPos.Y.Offset + delta.Y
			)
		end
	end)
	----------------------------------------------------------------

	-- Clique
	button.MouseButton1Click:Connect(function()
		jumpEnabled = not jumpEnabled
		setJumpEnabled(jumpEnabled)
		updateVisual()
	end)

	-- Respawn
	player.CharacterAdded:Connect(function()
		task.wait(0.1)
		setJumpEnabled(jumpEnabled)
		updateVisual()
	end)

	setJumpEnabled(jumpEnabled)
	updateVisual()
end

-- Garantir PlayerGui
if player:FindFirstChild("PlayerGui") then
	createFloatingButton()
else
	player:WaitForChild("PlayerGui")
	createFloatingButton()
end
